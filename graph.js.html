<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title>JSDoc: Source: graph.js</title>

    <script src="scripts/prettify/prettify.js"> </script>
    <script src="scripts/prettify/lang-css.js"> </script>
    <!--[if lt IE 9]>
      <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
    <link type="text/css" rel="stylesheet" href="styles/prettify-tomorrow.css">
    <link type="text/css" rel="stylesheet" href="styles/jsdoc-default.css">
</head>

<body>

<div id="main">

    <h1 class="page-title">Source: graph.js</h1>

    



    
    <section>
        <article>
            <pre class="prettyprint source linenums"><code>const BAR_WIDTH = 28;
const BAR_PADDING = 16;
const BAR_COLOR = '#eb4000';
const TEXT_HEIGHT = 14;
const TEXT_FONT = '12px Roboto';
const X_LABELS = ['Su', 'M', 'T', 'W', 'Th', 'F', 'Sa'];

/**
 * Draws a graph to the given canvas element with the given data points.
 * @param {HTMLCanvasElement} canvas Target canvas
 * @param {number[]} data An array
 */
export function drawGraph (canvas, data = [0, 0, 0, 0, 0, 0, 0]) {
  if (!canvas) return;
  // Shift data from MTWThFSaSu -> SuMTWThFSa
  data.unshift(data.pop());
  const ctx = canvas.getContext('2d');
  const axes = calculateAxes(data);
  drawAxes(ctx, canvas.height, canvas.width, axes);
  drawBars(ctx, canvas.height, data, axes);
}

/**
* @param {CanvasRenderingContext2D} ctx
* @param {number} canvasHeight
* @param {number} canvasWidth
* @param {number[]} axes
*/
function drawAxes (ctx, canvasHeight, canvasWidth, axes) {
  // draw axes
  // draw y-labels

  // draw x-labels
  ctx.font = TEXT_FONT;
  ctx.textAlign = 'center';
  for (const [i, label] of X_LABELS.entries()) {
    const x = 32 + i * (BAR_WIDTH + BAR_PADDING);
    const y = canvasHeight - 32 + 8 + (TEXT_HEIGHT / 2);
    ctx.fillText(label, x, y);
  }
}

/**
*
* @param {CanvasRenderingContext2D} ctx The canvas' 2d rendering context
* @param {number} canvasHeight The canvas' height
* @param {number[]} data
* @param {number[]} axes
*/
function drawBars (ctx, canvasHeight, data, axes) {
  const maxAxis = axes[axes.length - 1];
  const maxHeight = canvasHeight - 32;
  for (const [i, d] of data.entries()) {
    const barHeight = Math.round(maxHeight * (d / maxAxis));
    if (barHeight > 0) {
      const x = 32 + i * (BAR_WIDTH + BAR_PADDING);
      const y = maxHeight - barHeight;
      drawBar(ctx, x, y, BAR_WIDTH, barHeight, BAR_COLOR);
    }
  }
}

/**
 * Calculate and return 4 y-axes used in the graph. The first axis will always
 * be 0.
 * @param {number[]} data The weekly data to scale the axes by.
 * @return {number[]} The axes in array form, from first axis to last axis.
 */
function calculateAxes (data) {
  // if max data
  //      0 - 3 => just dont change max
  //      4 - 10 => round max up 1
  //      11 - 30 => round max up 2
  // spacing = max axis / 4

  // distribute the spacing
  const axes = [0, 1, 2, 3];

  // Calculating current max pomo cycles within week
  let max = Math.max(...data);

  // Checking max value to determine axes values
  if (max &lt; 4) {
    return axes;
  } else if (max &lt; 11) {
    max += 1;
  } else {
    max += 2;
  }

  // Setting axes values and rounding to one decimal place
  axes[1] = (max / 3).toFixed(1);
  axes[2] = (2 * max / 3).toFixed(1);
  axes[3] = max;

  // Checking max value to determine axes values
  if (max &lt; 4) {
    return axes;
  } else if (max &lt; 11) {
    max += 1;
  } else {
    max += 2;
  }

  // Setting axes values and rounding to one decimal place
  axes[1] = (max / 3).toFixed(1);
  axes[2] = (2 * max / 3).toFixed(1);
  axes[3] = max;

  return axes;
}

/**
 * Draws a bar centered at (x, y) with w width (horizontal) and h height
 * (vertical), using the given canvas' context.
 * Default color is black (#000000).
 * @param {CanvasRenderingContext2D} ctx Target canvas' context
 * @param {number} x horizontal position of upper-left corner
 * @param {number} y vertical position of upper-left corner
 * @param {number} w width
 * @param {number} h height
 * @param {?string} color hex color (e.g. #fafefc)
 */
function drawBar (ctx, x, y, w, h, color = '#000000') {
  ctx.save();
  ctx.fillStyle = color;
  ctx.fillRect(x - Math.round(w / 2), y, w, h);
  ctx.restore();
}
</code></pre>
        </article>
    </section>




</div>

<nav>
    <h2><a href="index.html">Home</a></h2><h3>Global</h3><ul><li><a href="global.html#beginCountdown">beginCountdown</a></li><li><a href="global.html#calculateAxes">calculateAxes</a></li><li><a href="global.html#closeStatsPane">closeStatsPane</a></li><li><a href="global.html#currentTime">currentTime</a></li><li><a href="global.html#displayTodayStats">displayTodayStats</a></li><li><a href="global.html#displayTotalStats">displayTotalStats</a></li><li><a href="global.html#drawAxes">drawAxes</a></li><li><a href="global.html#drawBar">drawBar</a></li><li><a href="global.html#drawBars">drawBars</a></li><li><a href="global.html#drawGraph">drawGraph</a></li><li><a href="global.html#events">events</a></li><li><a href="global.html#formatDate">formatDate</a></li><li><a href="global.html#increaseTaskPomo">increaseTaskPomo</a></li><li><a href="global.html#isSameWeek">isSameWeek</a></li><li><a href="global.html#keys">keys</a></li><li><a href="global.html#openStatsPane">openStatsPane</a></li><li><a href="global.html#resetTaskPomo">resetTaskPomo</a></li><li><a href="global.html#resetTimer">resetTimer</a></li><li><a href="global.html#resetWeekArray">resetWeekArray</a></li><li><a href="global.html#startResetController">startResetController</a></li><li><a href="global.html#startTimer">startTimer</a></li><li><a href="global.html#taskComplete">taskComplete</a></li><li><a href="global.html#timeFraction">timeFraction</a></li><li><a href="global.html#timerOptions">timerOptions</a></li><li><a href="global.html#toggleAccessibility">toggleAccessibility</a></li><li><a href="global.html#togglePomoBreak">togglePomoBreak</a></li><li><a href="global.html#toggleTaskButtonDisabled">toggleTaskButtonDisabled</a></li><li><a href="global.html#updateDistractions">updateDistractions</a></li><li><a href="global.html#updateLocalStorage">updateLocalStorage</a></li><li><a href="global.html#updatePomoCount">updatePomoCount</a></li><li><a href="global.html#updateStats">updateStats</a></li><li><a href="global.html#.onclick">.onclick</a></li></ul>
</nav>

<br class="clear">

<footer>
    Documentation generated by <a href="https://github.com/jsdoc/jsdoc">JSDoc 3.6.4</a> on Tue Mar 09 2021 09:15:37 GMT+0000 (Coordinated Universal Time)
</footer>

<script> prettyPrint(); </script>
<script src="scripts/linenumber.js"> </script>
</body>
</html>
